<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>File (read-dwarf.Config.File)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">read-dwarf</a> &#x00BB; <a href="../index.html">Config</a> &#x00BB; File</nav><h1>Module <code>Config.File</code></h1><p>This module is to handle the configuration file of the program.</p><p>For now I expect a TOML format and use the <code>toml</code> library from opam. The data structure themselves are format agnostic so if we change the TOML library of change of format, only this file must be modified. For example to JSON or YAML.</p><p>The top level usage is to first set the <code>file</code> reference which will be done by <a href="../CommonOpt/index.html#val-config"><code>CommonOpt.config</code></a> using <a href="index.html#val-ensure_loaded"><code>ensure_loaded</code></a>. Then the config can be accessed with the various <a href="index.html#acc"><span>Accessors</span></a></p><nav class="toc"><ul><li><a href="#configuration-structure">Configuration structure</a></li><li><a href="#file-loading">File loading</a></li><li><a href="#acc">Accessors</a></li></ul></nav></header><section><header><h2 id="configuration-structure"><a href="#configuration-structure" class="anchor"></a>Configuration structure</h2><p>All field of records in this section have a matching line in the checked-in <code>config.toml</code>. If something is optional here, and should be disabled in the default <code>config.toml</code>, put a commented line there, so that the correspondence can be immediately seen.</p></header><div class="spec module" id="module-ArchConf"><a href="#module-ArchConf" class="anchor"></a><code><span class="keyword">module</span> <a href="ArchConf/index.html">ArchConf</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Z3"><a href="#module-Z3" class="anchor"></a><code><span class="keyword">module</span> <a href="Z3/index.html">Z3</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec type" id="type-archs_type"><a href="#type-archs_type" class="anchor"></a><code><span class="keyword">type</span> archs_type</code><code> = <span><span>(<a href="../Arch/index.html#type-t">Arch.t</a>, <a href="ArchConf/index.html#type-t">ArchConf.t</a>)</span> Stdlib.Hashtbl.t</span></code></dt><dd><p>Each architecture specific configuration is specified by a TOML section represented by a <a href="../Arch/index.html#type-t"><code>Arch.t</code></a> record. They are stored in this type</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = </code><code>{</code><table class="record"><tr id="type-t.arch" class="anchored"><td class="def field"><a href="#type-t.arch" class="anchor"></a><code>arch : <span><a href="../Arch/index.html#type-t">Arch.t</a> option</span>;</code></td><td class="doc"><p>The default architecture to be choosen when no ELF file is specified on the CLI. This is optional, but if supplied, it will override <a href="../index.html#val-arch"><code>Config.arch</code></a></p></td></tr><tr id="type-t.archs" class="anchored"><td class="def field"><a href="#type-t.archs" class="anchor"></a><code>archs : <a href="index.html#type-archs_type">archs_type</a>;</code></td><td class="doc"><p>All the architecture specific configurations</p></td></tr><tr id="type-t.z3" class="anchored"><td class="def field"><a href="#type-t.z3" class="anchor"></a><code>z3 : <a href="Z3/index.html#type-t">Z3.t</a>;</code></td><td class="doc"><p>The Z3 configuration</p></td></tr></table><code>}</code></dt></dl></section><section><header><h2 id="file-loading"><a href="#file-loading" class="anchor"></a>File loading</h2><p>This section is about loading the configuration from a TOML file</p></header><dl><dt class="spec value" id="val-load"><a href="#val-load" class="anchor"></a><code><span class="keyword">val</span> load : string <span>&#45;&gt;</span> unit</code></dt><dd><p>Load the configuration file from the specified file name</p></dd></dl><dl><dt class="spec value" id="val-ensure_loaded"><a href="#val-ensure_loaded" class="anchor"></a><code><span class="keyword">val</span> ensure_loaded : string <span>&#45;&gt;</span> unit</code></dt><dd><p>If the configuration file is not already loaded, load it from the specified file.</p></dd></dl></section><section><header><h2 id="acc"><a href="#acc" class="anchor"></a>Accessors</h2><p>The section provide various accessor to access directly part of the configuration</p><p>The config must be loaded otherwise <a href="index.html#exception-UnloadedConfig"><code>UnloadedConfig</code></a> will be thrown</p></header><dl><dt class="spec exception" id="exception-UnloadedConfig"><a href="#exception-UnloadedConfig" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">UnloadedConfig</span></code></dt><dd><p>This exception will be raised if any of the accessor is called while the config is not loaded.</p></dd></dl><dl><dt class="spec value" id="val-get_config"><a href="#val-get_config" class="anchor"></a><code><span class="keyword">val</span> get_config : unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Get all the configuration information</p></dd></dl><dl><dt class="spec value" id="val-get_arch_name"><a href="#val-get_arch_name" class="anchor"></a><code><span class="keyword">val</span> get_arch_name : unit <span>&#45;&gt;</span> <a href="../Arch/index.html#type-t">Arch.t</a></code></dt><dd><p>Get the default architecture name to be used if no architecture is implicitly or explicitly specified on the CLI</p></dd></dl><dl><dt class="spec value" id="val-get_arch_config"><a href="#val-get_arch_config" class="anchor"></a><code><span class="keyword">val</span> get_arch_config : <a href="../Arch/index.html#type-t">Arch.t</a> <span>&#45;&gt;</span> <a href="ArchConf/index.html#type-t">ArchConf.t</a></code></dt><dd><p>Get the architecture configuration for a specific architecture. To get the architecture configuration of the currently enabled architecture, Call <span class="xref-unresolved" title="unresolved reference to &quot;Arch.get_config&quot;"><a href="../index.html#module-Arch"><code>Arch</code></a>.get_config</span></p></dd></dl><dl><dt class="spec value" id="val-get_isla_config"><a href="#val-get_isla_config" class="anchor"></a><code><span class="keyword">val</span> get_isla_config : <a href="../Arch/index.html#type-t">Arch.t</a> <span>&#45;&gt;</span> <a href="ArchConf/Isla/index.html#type-t">ArchConf.Isla.t</a></code></dt><dd><p>Get the isla configuration for a specific architecture. To get the isla configuration of the currently enabled architecture, Call <span class="xref-unresolved" title="unresolved reference to &quot;Arch.get_isla_config&quot;"><a href="../index.html#module-Arch"><code>Arch</code></a>.get_isla_config</span></p></dd></dl><dl><dt class="spec value" id="val-get_z3_config"><a href="#val-get_z3_config" class="anchor"></a><code><span class="keyword">val</span> get_z3_config : unit <span>&#45;&gt;</span> <a href="Z3/index.html#type-t">Z3.t</a></code></dt><dd><p>Get the Z3 configuration</p></dd></dl></section></div></body></html>