<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Server (read-dwarf.Isla__.Server)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">read-dwarf</a> &#x00BB; <a href="../index.html">Isla__</a> &#x00BB; Server</nav><h1>Module <code>Isla__.Server</code></h1></header><aside><p>This module is about launching isla as a background server and using it</p><p>Important remark: even if I call isla a server because in a logical sense read-dwarf is making request to isla and isla is serving them, in Unix sense read-dwarf is the server because it listen to the socket and isla connect to it.</p></aside><div class="spec module" id="module-ConfigFile"><a href="#module-ConfigFile" class="anchor"></a><code><span class="keyword">module</span> ConfigFile = <a href="../../Config/index.html#module-File">Config.File</a></code></div><div class="spec module" id="module-CommonOpt"><a href="#module-CommonOpt" class="anchor"></a><code><span class="keyword">module</span> CommonOpt = <a href="../../Config/index.html#module-CommonOpt">Config.CommonOpt</a></code></div><div class="spec module" id="module-Config"><a href="#module-Config" class="anchor"></a><code><span class="keyword">module</span> <a href="Config/index.html">Config</a> = <a href="../../Config__File/ArchConf/index.html#module-Isla">Config.File.ArchConf.Isla</a></code></div><div class="spec module" id="module-Server"><a href="#module-Server" class="anchor"></a><code><span class="keyword">module</span> Server = <a href="../../Utils/Cmd/index.html#module-SocketServer">Utils.Cmd.SocketServer</a></code></div><dl><dt class="spec type" id="type-config"><a href="#type-config" class="anchor"></a><code><span class="keyword">type</span> config</code><code> = <a href="../../Config__File/ArchConf/Isla/index.html#type-t">Config.t</a></code></dt><dd><p>The configuration record type</p></dd></dl><dl><dt class="spec type" id="type-trcs"><a href="#type-trcs" class="anchor"></a><code><span class="keyword">type</span> trcs</code><code> = <span><span>(bool * <a href="../../Isla/Base/index.html#type-rtrc">Isla.Base.rtrc</a>)</span> list</span></code></dt><dd><p>The raw output of the server for an instruction.</p><p>It is a list of traces, each with a flag telling if they are normal traces (no processor exception/fault) or not</p></dd></dl><dl><dt class="spec value" id="val-required_version"><a href="#val-required_version" class="anchor"></a><code><span class="keyword">val</span> required_version : string</code></dt><dd><p>Bump when updating isla. TODO: move the version checking to allow a range of version. Also, right now the cache invalidation is based on this and not on the actual isla version, which may be dangerous.</p></dd></dl><dl><dt class="spec value" id="val-req_num"><a href="#val-req_num" class="anchor"></a><code><span class="keyword">val</span> req_num : <span>int Stdlib.ref</span></code></dt><dt class="spec value" id="val-server"><a href="#val-server" class="anchor"></a><code><span class="keyword">val</span> server : <span><span><a href="../../Utils__Cmd/SocketServer/index.html#type-t">Server.t</a> option</span> Stdlib.ref</span></code></dt><dd><p>This instance of socket server for isla</p></dd></dl><dl><dt class="spec value" id="val-get_server"><a href="#val-get_server" class="anchor"></a><code><span class="keyword">val</span> get_server : unit <span>&#45;&gt;</span> <a href="../../Utils__Cmd/SocketServer/index.html#type-t">Server.t</a></code></dt><dd><p>Assume the server is started and get it out of the reference</p></dd></dl><dl><dt class="spec value" id="val-cmd_of_config"><a href="#val-cmd_of_config" class="anchor"></a><code><span class="keyword">val</span> cmd_of_config : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>string array</span></code></dt><dd><p>Compute the isla-client command line from the isla configuration</p></dd></dl><dl><dt class="spec value" id="val-raw_start"><a href="#val-raw_start" class="anchor"></a><code><span class="keyword">val</span> raw_start : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Start the server with the specified architecture, do not attempt any checks</p></dd></dl><dl><dt class="spec value" id="val-raw_stop"><a href="#val-raw_stop" class="anchor"></a><code><span class="keyword">val</span> raw_stop : unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Stop the server by cutting the connection.</p></dd></dl><dl><dt class="spec type" id="type-basic_answer"><a href="#type-basic_answer" class="anchor"></a><code><span class="keyword">type</span> basic_answer</code><code> = </code><table class="variant"><tr id="type-basic_answer.Error" class="anchored"><td class="def constructor"><a href="#type-basic_answer.Error" class="anchor"></a><code>| </code><code><span class="constructor">Error</span></code></td></tr><tr id="type-basic_answer.Version" class="anchored"><td class="def constructor"><a href="#type-basic_answer.Version" class="anchor"></a><code>| </code><code><span class="constructor">Version</span> <span class="keyword">of</span> string</code></td></tr><tr id="type-basic_answer.StartTraces" class="anchored"><td class="def constructor"><a href="#type-basic_answer.StartTraces" class="anchor"></a><code>| </code><code><span class="constructor">StartTraces</span></code></td></tr><tr id="type-basic_answer.Trace" class="anchored"><td class="def constructor"><a href="#type-basic_answer.Trace" class="anchor"></a><code>| </code><code><span class="constructor">Trace</span> <span class="keyword">of</span> bool * string</code></td></tr><tr id="type-basic_answer.EndTraces" class="anchored"><td class="def constructor"><a href="#type-basic_answer.EndTraces" class="anchor"></a><code>| </code><code><span class="constructor">EndTraces</span></code></td></tr></table></dt><dd><p>This should match exactly with the Answer type in isla-client code</p></dd></dl><dl><dt class="spec value" id="val-read_basic_answer"><a href="#val-read_basic_answer" class="anchor"></a><code><span class="keyword">val</span> read_basic_answer : unit <span>&#45;&gt;</span> <a href="index.html#type-basic_answer">basic_answer</a></code></dt><dd><p>Read an answer from isla-client. This must match exactly <code>write_answer</code> in <code>client.rs</code> in <code>isla</code></p></dd></dl><dl><dt class="spec type" id="type-answer"><a href="#type-answer" class="anchor"></a><code><span class="keyword">type</span> answer</code><code> = </code><table class="variant"><tr id="type-answer.Version" class="anchored"><td class="def constructor"><a href="#type-answer.Version" class="anchor"></a><code>| </code><code><span class="constructor">Version</span> <span class="keyword">of</span> string</code></td></tr><tr id="type-answer.Traces" class="anchored"><td class="def constructor"><a href="#type-answer.Traces" class="anchor"></a><code>| </code><code><span class="constructor">Traces</span> <span class="keyword">of</span> <span><span>(bool * string)</span> list</span></code></td></tr></table></dt><dd><p>The interpreted answer. If the protocol is followed, then one request lead to exactly one answer of that type</p></dd></dl><dl><dt class="spec value" id="val-expect_version"><a href="#val-expect_version" class="anchor"></a><code><span class="keyword">val</span> expect_version : <a href="index.html#type-answer">answer</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Expect a version answer and fails if it is not the case</p></dd></dl><dl><dt class="spec value" id="val-expect_traces"><a href="#val-expect_traces" class="anchor"></a><code><span class="keyword">val</span> expect_traces : <a href="index.html#type-answer">answer</a> <span>&#45;&gt;</span> <span><span>(bool * string)</span> list</span></code></dt><dd><p>Expect isla traces and fails if it is not the case</p></dd></dl><dl><dt class="spec value" id="val-expect_parsed_traces"><a href="#val-expect_parsed_traces" class="anchor"></a><code><span class="keyword">val</span> expect_parsed_traces : <a href="index.html#type-answer">answer</a> <span>&#45;&gt;</span> <a href="index.html#type-trcs">trcs</a></code></dt><dd><p>Expect isla traces and fails if it is not the case, additionally parse them</p></dd></dl><dl><dt class="spec exception" id="exception-IslaError"><a href="#exception-IslaError" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">IslaError</span></code></dt><dd><p>When isla encounter a non fatal error with that specific request. This error is recoverable and the sever can accept other requests</p></dd></dl><dl><dt class="spec value" id="val-read_answer"><a href="#val-read_answer" class="anchor"></a><code><span class="keyword">val</span> read_answer : unit <span>&#45;&gt;</span> <a href="index.html#type-answer">answer</a></code></dt><dd><p>Read the answer from isla, block until full answer</p></dd></dl><dl><dt class="spec value" id="val-pp_answer"><a href="#val-pp_answer" class="anchor"></a><code><span class="keyword">val</span> pp_answer : <a href="index.html#type-answer">answer</a> <span>&#45;&gt;</span> PPrintEngine.document</code></dt><dd><p>Answer pretty printer</p></dd></dl><dl><dt class="spec type" id="type-request"><a href="#type-request" class="anchor"></a><code><span class="keyword">type</span> request</code><code> = </code><table class="variant"><tr id="type-request.TEXT_ASM" class="anchored"><td class="def constructor"><a href="#type-request.TEXT_ASM" class="anchor"></a><code>| </code><code><span class="constructor">TEXT_ASM</span> <span class="keyword">of</span> string</code></td></tr><tr id="type-request.ASM" class="anchored"><td class="def constructor"><a href="#type-request.ASM" class="anchor"></a><code>| </code><code><span class="constructor">ASM</span> <span class="keyword">of</span> <a href="../../Utils/BytesSeq/index.html#type-t">Utils.BytesSeq.t</a></code></td></tr><tr id="type-request.VERSION" class="anchored"><td class="def constructor"><a href="#type-request.VERSION" class="anchor"></a><code>| </code><code><span class="constructor">VERSION</span></code></td></tr><tr id="type-request.STOP" class="anchored"><td class="def constructor"><a href="#type-request.STOP" class="anchor"></a><code>| </code><code><span class="constructor">STOP</span></code></td></tr></table></dt><dd><p>The type of a request to isla</p></dd></dl><dl><dt class="spec value" id="val-string_of_request"><a href="#val-string_of_request" class="anchor"></a><code><span class="keyword">val</span> string_of_request : <a href="index.html#type-request">request</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Convert a request into the string message expected by isla-client This should match the protocol</p></dd></dl><dl><dt class="spec value" id="val-send_string_request"><a href="#val-send_string_request" class="anchor"></a><code><span class="keyword">val</span> send_string_request : string <span>&#45;&gt;</span> unit</code></dt><dd><p>Send a string request to the server, and do not wait for any answer</p></dd></dl><dl><dt class="spec value" id="val-string_request"><a href="#val-string_request" class="anchor"></a><code><span class="keyword">val</span> string_request : string <span>&#45;&gt;</span> <a href="index.html#type-answer">answer</a></code></dt><dd><p>Same as <a href="index.html#type-request"><code>request</code></a> but takes the request directly as a string</p></dd></dl><dl><dt class="spec value" id="val-request"><a href="#val-request" class="anchor"></a><code><span class="keyword">val</span> request : <a href="index.html#type-request">request</a> <span>&#45;&gt;</span> <a href="index.html#type-answer">answer</a></code></dt><dd><p>Send a request and wait for answer</p></dd></dl><dl><dt class="spec value" id="val-request_bin_parsed"><a href="#val-request_bin_parsed" class="anchor"></a><code><span class="keyword">val</span> request_bin_parsed : <a href="../../Utils/BytesSeq/index.html#type-t">Utils.BytesSeq.t</a> <span>&#45;&gt;</span> <a href="index.html#type-trcs">trcs</a></code></dt><dd><p>Request the traces of a binary instruction and parse the result.</p><p>This is the main entry point of this module.</p></dd></dl><dl><dt class="spec value" id="val-send_request"><a href="#val-send_request" class="anchor"></a><code><span class="keyword">val</span> send_request : <a href="index.html#type-request">request</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Send a request without expecting any answer</p></dd></dl><dl><dt class="spec value" id="val-stop"><a href="#val-stop" class="anchor"></a><code><span class="keyword">val</span> stop : unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Stop isla client by sending a stop request</p></dd></dl><dl><dt class="spec value" id="val-start"><a href="#val-start" class="anchor"></a><code><span class="keyword">val</span> start : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Start isla and check version</p></dd></dl><aside><p>Test that isla can start and keep a valid version</p></aside><dl><dt class="spec module" id="module-Cmd"><a href="#module-Cmd" class="anchor"></a><code><span class="keyword">module</span> <a href="Cmd/index.html">Cmd</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>This module provide a CLI subcommand to test isla directly. All isla output is reported as raw text</p></dd></dl></div></body></html>